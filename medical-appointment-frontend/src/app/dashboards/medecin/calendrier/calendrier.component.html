<div class="calendar-container">
    <div class="calendar-header">
        <h2>Calendrier des consultations</h2>
        <button class="btn btn-primary" (click)="openCreateRdvModal()">
            <i class="fas fa-plus"></i> Nouveau RDV
        </button>
    </div>

    <full-calendar [options]="calendarOptions"></full-calendar>
</div>

<!-- Modal de création de RDV -->
<dialog #rdvModal class="rdv-modal">
    <div class="modal-content">
        <button class="close-btn" (click)="closeModal()">
            <i class="fas fa-times"></i>
        </button>

        <h3>Créer un nouveau rendez-vous</h3>

        <form [formGroup]="rdvForm" (ngSubmit)="onSubmit()">
            <div class="form-group">
                <label for="patient">Patient *</label>
                <select id="patient" formControlName="patientId" class="form-control">
                    <option value="" disabled selected>Sélectionnez un patient</option>
                    <option *ngFor="let patient of patients" [value]="patient.id">
                        {{ patient.nom }} {{ patient.prenom }}
                    </option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="date">Date *</label>
                    <input type="date" id="date" formControlName="date" class="form-control">
                </div>

                <div class="form-group">
                    <label for="heureDebut">Heure de début *</label>
                    <select id="heureDebut" formControlName="heureDebut" class="form-control">
                        <option value="" disabled selected>Sélectionnez un créneau</option>
                        <option *ngFor="let dispo of disponibilitesJour" [value]="dispo.heureDebut">
                            {{ dispo.heureDebut }} - {{ dispo.heureFin }}
                        </option>
                    </select>

                </div>

                <div class="form-group">
                    <label for="duree">Durée *</label>
                    <select id="duree" formControlName="duree" class="form-control">
                        <option value="15">15 min</option>
                        <option value="30" selected>30 min</option>
                        <option value="45">45 min</option>
                        <option value="60">60 min</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="typeConsultation">Type de consultation *</label>
                <select id="typeConsultation" formControlName="typeConsultation" class="form-control">
                    <option value="GENERALE" selected>Consultation générale</option>
                    <option value="SUIVI">Suivi médical</option>
                    <option value="URGENCE">Urgence</option>
                    <option value="SPECIALISTE">Spécialiste</option>
                </select>
            </div>

            <div class="form-group">
                <label for="notes">Notes</label>
                <textarea id="notes" formControlName="notes" class="form-control" rows="3"></textarea>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-outline" (click)="closeModal()">
                    Annuler
                </button>
                <button type="submit" class="btn btn-primary" [disabled]="isSubmitting">
                    <span *ngIf="isSubmitting">
                        <i class="fas fa-spinner fa-spin"></i> Création...
                    </span>
                    <span *ngIf="!isSubmitting">
                        Créer le rendez-vous
                    </span>
                </button>
            </div>
        </form>
    </div>
</dialog>